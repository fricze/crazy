<!doctype html>
<html>
    <head>
        <title>Web Dev for 2024</title>
        <style>
            * {
                box-sizing: border-box;
            }

            p {
                margin: 0;
                padding: 0;
            }

            .dvh {
                code {
                    font-size: 2vw;
                }
            }

            @keyframes fade-in {
                0% {
                    /* clip-path: circle(50% at 50% 50%); */
                    clip-path: inset(50%);
                    opacity: 0;
                }
                100% {
                    opacity: 1;
                    clip-path: inset(0%);
                    /* clip-path: circle(70.7% at 50% 50%); */
                }
            }

            @keyframes fade-out {
                0% {
                    clip-path: circle(70.7% at 50% 50%);
                }
                100% {
                    opacity: 0;
                    scale: 3;
                    clip-path: circle(50% at 50% 50%);
                }
            }

            @keyframes slide-from-right {
                from {
                    transform: translateX(30px);
                }
            }

            @keyframes slide-to-left {
                to {
                    transform: translateX(-30px);
                }
            }

            ::view-transition-old(root) {
                animation:
                    0.8s cubic-bezier(0.4, 0, 1, 1) both fade-out,
                    0.8s cubic-bezier(0.4, 0, 0.2, 1) both slide-to-left;
            }

            ::view-transition-new(root) {
                animation:
                    0.8s cubic-bezier(0, 0, 0.2, 1) both fade-in,
                    0.8s cubic-bezier(0.4, 0, 0.2, 1) both slide-from-right;
                animation-delay: 1s;
            }

            .view-transition {
                display: flex;
                flex-direction: row;
                position: relative;
                height: 100vh;

                p:first-child {
                    position: absolute;
                    font-size: 8vw;
                    color: deeppink;
                }

                p:last-child {
                    position: absolute;
                    font-size: 2vw;
                    width: 60vw;
                    bottom: 30%;
                    left: 7%;
                    color: #fff;
                }

                &.gallery img {
                    display: block;
                }

                img {
                    display: none;
                    width: 30vw;
                    aspect-ratio: 1;
                    object-fit: cover;
                }
            }

            .entry-exit {
                gap: 2vw;
                row-gap: 2lh;
                grid-template-rows: 2lh max-content;
                grid-template-columns: 1fr 1fr 1fr;

                p {
                    grid-column: 1 / 3;
                }

                p,
                button {
                    grid-row: 1 / 2;
                }

                button {
                    cursor: pointer;
                    font-size: 2vw;
                    white-space: nowrap;
                    padding: 0.5lh;
                    background: #fff;
                    border-radius: 5px;
                }

                img {
                    grid-row: 2 / 3;
                    cursor: pointer;

                    &.removed {
                        opacity: 0;
                        rotate: 5deg;
                        display: none;
                        clip-path: circle(50% at 50% 50%);
                    }

                    width: 30vw;
                    aspect-ratio: 1;
                    object-fit: cover;
                    transition: all 0.5s;
                    transition-behavior: allow-discrete;
                    clip-path: circle(70.7% at 50% 50%);

                    @starting-style {
                        filter: brightness(2);
                        rotate: 5deg;
                        clip-path: circle(50% at 50% 50%);
                    }
                }
            }

            .horizontal {
                display: flex;
                gap: 2vw;
                height: 150dvh;
                view-timeline-name: --section-pin-tl;
                view-timeline-axis: block;

                p {
                    white-space: nowrap;
                    place-self: baseline;
                }

                img {
                    translate: 100% -50%;
                    animation: linear move forwards;
                    animation-timeline: --section-pin-tl;
                    animation-range: contain 0% contain 100%;
                    width: 30vw;
                    aspect-ratio: 1;
                    object-fit: cover;
                    clip-path: circle(50% at 50% 50%);
                }
            }

            @keyframes move {
                0% {
                    clip-path: circle(50% at 50% 50%);
                }
                100% {
                    translate: -100% 50%;
                    clip-path: circle(70.7% at 50% 50%);
                }
            }

            .no-break {
                white-space: nowrap;
            }

            .sweet {
                place-self: center;
                color: deeppink;
                text-decoration: underline;
                text-decoration-thickness: 10px;
            }

            svg {
                height: 1000px;
                width: 100px;
                place-self: center;
            }

            svg circle#css-motion-path {
                animation: move-it 5s -2.5s infinite both linear;
                motion-path: path(
                    "M50,0 C100,0 100,50 50,50 C0,50 0,100 50,100 C100,100 100,150 50,150 C0,150 0,200 50,200 C100,200 100,250 50,250C0,250 0,300 50,300C100,300 100,350 50,350C0,350 0,400 50,400C100,400 100,450 50,450C0,450 0,500 50,500C100,500 100,550 50,550C0,550 0,600 50,600  C100,600 100,650 50,650    C0,650 0,700 50,700    C100,700 100,750 50,750    C0,750 0,800 50,800    C100,800 100,850 50,850    C0,850 0,900 50,900    C100,900 100,950 50,950    C0,950 0,1000 50,1000    C100,1000 100,1050 50,1050"
                );
                offset-path: path(
                    "M50,0 C100,0 100,50 50,50 C0,50 0,100 50,100 C100,100 100,150 50,150 C0,150 0,200 50,200 C100,200 100,250 50,250C0,250 0,300 50,300C100,300 100,350 50,350C0,350 0,400 50,400C100,400 100,450 50,450C0,450 0,500 50,500C100,500 100,550 50,550C0,550 0,600 50,600  C100,600 100,650 50,650    C0,650 0,700 50,700    C100,700 100,750 50,750    C0,750 0,800 50,800    C100,800 100,850 50,850    C0,850 0,900 50,900    C100,900 100,950 50,950    C0,950 0,1000 50,1000    C100,1000 100,1050 50,1050"
                );
            }

            @keyframes move-it {
                100% {
                    motion-offset: 100%;
                    offset-distance: 100%;
                }
            }

            :root,
            body {
                scrollbar-gutter: stable;
                scroll-snap-type: y mandatory;
                margin: 0;
                padding: 0;
                scrollbar-width: none;
                font-family: Arial, Helvetica, sans-serif;
            }

            .contain {
                contain: strict;

                &:hover {
                    p {
                        transition: all 0.7s;
                        font-size: 8vw;
                        color: deeppink;
                        font-weight: 800;
                        border-left: 20px solid deeppink;
                        padding-left: 3vw;
                    }

                    div {
                        transition: all 0.7s;
                        translate: 10% -140%;
                        font-size: 4vw;
                    }
                }
            }

            .user-form {
                display: grid;
                grid-template-columns: 1fr 1fr 1fr;
                grid-template-rows: 1lh 2lh 1lh 2lh max-content;
                width: 60vw;
                font-size: 1.4vw;
                row-gap: 0.5lh;
                column-gap: 2vw;

                &.custom {
                    accent-color: deeppink;
                }

                input[type="radio"] {
                    width: 16px;
                }

                fieldset {
                    grid-column: 3 / 4;
                    grid-row: 1 / 5;

                    display: flex;
                    flex-direction: column;
                    gap: 0.5lh;

                    div {
                        display: flex;
                    }
                }

                label {
                    grid-template-rows: subgrid;
                    display: grid;
                    grid-row: 1 / 3;
                    padding: 5px;

                    &:has(input:invalid) {
                        outline: 2px solid red;
                        border-radius: 4px;

                        p::after {
                            content: " (please fill the name)";
                            font-style: italic;
                            color: deeppink;
                        }
                    }

                    &:has(textarea) {
                        grid-row: 3 / 5;
                        grid-column: 1 / 3;
                    }

                    &:has(input[type="range"]) {
                        grid-row: 5 / 6;
                        display: flex;
                        flex-direction: column;
                    }

                    p {
                        grid-row: 1;
                    }
                    textarea,
                    input {
                        font-size: 1.4vw;
                        grid-row: 2;
                    }
                }
            }

            .info {
                background: #dddddd96;
                border: 1px solid #333;
                border-radius: 5px;
                position: relative;
                z-index: 5;
                padding: 0.5lh;
                place-self: center;
                animation: linear switch-color both;
                animation-timeline: --revealing-image;
                animation-range: entry 80% entry 180%;
            }

            section:has(.clipped-image) {
                view-timeline-name: --revealing-image;
                view-timeline-axis: block;
            }

            .clipped-image {
                animation: linear reveal both;
                animation-timeline: --revealing-image;
                animation-range: entry 80% entry 180%;
                overflow-clip-margin: content-box;
                overflow: clip;
                place-self: center;
            }

            section {
                width: 100%;
                height: 100dvh;
                display: grid;
                place-items: center;
                scroll-snap-align: start;
                font-size: 3vw;
                overflow: hidden;
                padding: 4vw;

                pre {
                    font-size: 1.4vw;
                }

                & > p {
                    max-width: 40ch;
                    text-wrap: balance;
                }
            }

            .container {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                width: 80vw;
                row-gap: 1lh;
                column-gap: 1vw;

                &.rectangle {
                    grid-template-columns: repeat(2, 1fr);
                    grid-auto-rows: 3lh;
                }

                &:not(.rectangle) {
                    .box:first-child {
                        grid-column: span 3;
                        color: deeppink;
                    }
                }

                .box {
                    grid-column: span 1;
                    container: box / inline-size;
                    position: relative;

                    img {
                        width: 100cqw;
                        object-fit: cover;
                        aspect-ratio: 2 / 1;

                        @container (min-width: 700px) {
                            aspect-ratio: 6 / 1;
                            position: absolute;
                            top: -10cqh;
                            opacity: 0.4;
                        }
                    }

                    p {
                        margin: 0;
                        padding: 0;
                        position: relative;
                        z-index: 1;
                    }
                }

                .content {
                    font-size: 8cqw;
                    text-decoration: underline;
                    text-underline-offset: 1cqw;
                    text-decoration-thickness: 1cqw;
                }
            }

            .gap-example {
                display: flex;
                background: #333;

                div {
                    padding: 20px;
                    border: 1px solid #333;
                    border-radius: 5px;
                    background: #fff;
                }
            }

            .big {
                height: 200dvh;
                display: flex;
                place-items: baseline;
                flex-direction: column;
                view-timeline: --subject-reveal block;

                .gap-example {
                    animation-timeline: --subject-reveal;
                    gap: 0px;
                    flex-wrap: wrap;
                    justify-content: space-between;

                    animation-name: appear;
                    animation-fill-mode: both;
                    animation-duration: 1ms; /* Firefox requires this to apply the animation */
                    animation-range: entry 60% exit;
                }
            }

            @keyframes appear {
                from {
                    gap: 0px;
                }

                to {
                    gap: 30vw;
                    translate: 0 100dvh;
                    background: #999;
                    font-size: 5vw;
                }
            }

            @keyframes reveal {
                0% {
                    opacity: 0;
                    clip-path: inset(45% 20% 45% 20%);
                }
                100% {
                    opacity: 1;
                    translate: 0% 70%;
                    clip-path: inset(0% 0% 0% 0%);
                }
            }

            @keyframes switch-color {
                0% {
                    color: #333;
                }
                50% {
                    color: deeppink;
                }
                100% {
                    opacity: 0;
                }
            }
        </style>
    </head>
    <body>
        <section>
            <pre>const withDefault = x => x ?? "";</pre>
        </section>

        <section>
            <pre>opt.chaining.for.data.not.there</pre>
        </section>

        <section>
            <p>
                `Promise.allSettled` If one of your promises fails… you still
                can get result from those that suceeded
            </p>
        </section>
        <section>
            <p>
                and if you want to create promise that might be fulfilled later…
                just use `Promise.withResolvers`
            </p>
        </section>

        <section>
            <p>
                if your async actions need synchronization, wrap them in async
                iterable and collect with `Array.fromAsync`
            </p>
        </section>

        <section>
            <p>
                and if you need async event bus, there’s a native one in JS!
                just subclass EventTarget (or use it directly!)
            </p>
        </section>

        <section>
            <p>if you need grouping, just go with Object.groupBy</p>
        </section>

        <section>
            <p>
                and if you’re writing React, you may find these methods useful:
                .toSorted .toReversed .with .toSpliced
            </p>
        </section>

        <section class="dvh">
            <p>
                To make sure, your element has full window height, even on
                mobile with controls visible, use dvh unit. It’s what I’m using
                here, so it will be viewable even on mobile.
            </p>
            <pre>
section {
  height: 100dvh;
}</pre
            >
        </section>

        <section class="big">
            <p>
                To create a distance between flex / grid elements – just use gap
                property. No more overlapping margins problems! Gap is simple
                and just works
            </p>
            <div class="gap-example">
                <div>block 1</div>
                <div>block 2</div>
                <div>block 3</div>
                <div>block 4</div>
            </div>
        </section>

        <section>
            <p>
                If your component has to adjust to different containers and
                places on page, use container queries and container units. Font
                size in <code class="hljs language-css">.box</code> is based on
                container width.
            </p>

            <div class="container">
                <div class="box">
                    <div class="content">I'm just a .box</div>
                </div>
                <div class="box">
                    <div class="content">I'm also a .box</div>
                </div>
                <div class="box">
                    <div class="content">I'm also a .box</div>
                </div>
                <div class="box">
                    <div class="content">I'm also a .box</div>
                </div>
            </div>
        </section>

        <section>
            <p>You can have fun with layout too!</p>

            <div class="container">
                <div class="box">
                    <div class="content">
                        <img src="./tree.webp" />
                        <p>I'm just a .box</p>
                    </div>
                </div>
                <div class="box">
                    <div class="content">
                        <img src="./tree.webp" />
                        <p>I'm also a .box</p>
                    </div>
                </div>
                <div class="box">
                    <div class="content">
                        <img src="./tree.webp" />
                        <p>I'm also a .box</p>
                    </div>
                </div>
                <div class="box">
                    <div class="content">
                        <img src="./tree.webp" />
                        <p>I'm also a .box</p>
                    </div>
                </div>
            </div>
        </section>

        <section>
            <div class="container rectangle">
                <div class="box">
                    <div class="content">I'm just a .box</div>
                </div>
                <div class="box">
                    <div class="content">I'm also a .box</div>
                </div>
                <div class="box">
                    <div class="content">I'm also a .box</div>
                </div>
                <div class="box">
                    <div class="content">I'm also a .box</div>
                </div>
            </div>
        </section>

        <section>
            <p>
                and if you want similar possibilities for older browsers, check
                out
                <a
                    href="https://css-tricks.com/the-raven-technique-one-step-closer-to-container-queries/"
                    >The Raven Technique</a
                >
            </p>
            <pre>
--breakpoint_wide: 1500px;
/* Wider than 1500px will be considered wide */
--breakpoint_medium: 800px;
/* From 801px to 1500px will be considered medium */
/* Smaller than or exact 800px will be small */
--is_wide: clamp(0px,
  var(--base_size) - var(--breakpoint_wide),
  1px
);
</pre
            >
        </section>

        <section>
            <p>To make full use of CSS grid, check out subgrid</p>

            <form class="user-form">
                <label>
                    <p>Name</p>
                    <input type="text" />
                </label>

                <label>
                    <p>Email</p>
                    <input type="text" />
                </label>

                <fieldset>
                    <legend>Sex</legend>

                    <div>
                        <input
                            type="radio"
                            id="male1"
                            name="gender1"
                            value="male"
                            checked
                        />
                        <label for="male">Male</label>
                    </div>

                    <div>
                        <input
                            type="radio"
                            id="female1"
                            name="gender1"
                            value="female"
                        />
                        <label for="female">Female</label>
                    </div>
                </fieldset>

                <label>
                    <p>Your CV</p>
                    <textarea></textarea>
                </label>

                <label>
                    <p>Provide your age</p>
                    <input type="range" />
                </label>
            </form>
        </section>

        <section>
            <p>Use accent-color if you want to customize your form controls</p>

            <form class="user-form custom">
                <label>
                    <p>Name</p>
                    <input type="text" />
                </label>

                <label>
                    <p>Email</p>
                    <input type="text" />
                </label>

                <fieldset>
                    <legend>Sex</legend>

                    <div>
                        <input
                            type="radio"
                            id="male"
                            name="gender"
                            value="male"
                            checked
                        />
                        <label for="male">Male</label>
                    </div>

                    <div>
                        <input
                            type="radio"
                            id="female"
                            name="gender"
                            value="female"
                        />
                        <label for="female">Female</label>
                    </div>
                </fieldset>

                <label>
                    <p>Your CV</p>
                    <textarea></textarea>
                </label>

                <label>
                    <p>Provide your age</p>
                    <input type="range" />
                </label>
            </form>
        </section>

        <section>
            <p>
                Parent selector <code class="hljs language-css">:has()</code> is
                a great help if you want to style parent, based on state of
                children
            </p>

            <form class="user-form custom">
                <label>
                    <p>Name</p>
                    <input type="text" required />
                </label>

                <label>
                    <p>Email</p>
                    <input type="text" />
                </label>

                <fieldset>
                    <legend>Sex</legend>

                    <div>
                        <input
                            type="radio"
                            id="male"
                            name="gender"
                            value="male"
                            checked
                        />
                        <label for="male">Male</label>
                    </div>

                    <div>
                        <input
                            type="radio"
                            id="female"
                            name="gender"
                            value="female"
                        />
                        <label for="female">Female</label>
                    </div>
                </fieldset>

                <label>
                    <p>Your CV</p>
                    <textarea></textarea>
                </label>

                <label>
                    <p>Provide your age</p>
                    <input type="range" />
                </label>
            </form>
        </section>

        <section>
            <p>
                or `display: contents` for similar „hacky” version, that’s
                little less elastic, but might be enough for some situations
            </p>
        </section>

        <section>
            <p>
                If your application is huge, and you want to defer rendering of
                some parts, just go with
                <code class="hljs language-css">content-visibility: auto</code>
            </p>
        </section>

        <section>
            <img src="./content-vis.webp" />
        </section>

        <section>
            <p>
                If some part of your application updates more often than others,
                and has some crazy animations in it, you can
                <code class="hljs language-css no-break">contain: strict</code>,
                so browser will know, that this layer should not impact
                rendering of other layers
            </p>
        </section>

        <section class="contain">
            <p>This text can change font size, color and border</p>
            <div>and it doesn't matter to rest of application</div>
        </section>

        <section class="big">
            <p>To make your animation go on a path, use motion path</p>
            <svg viewBox="0 0 100 1000">
                <path
                    stroke="#444"
                    fill="none"
                    stroke-width="2"
                    d="M50,0 C100,0 100,50 50,50
                C0,50 0,100 50,100
                C100,100 100,150 50,150
                C0,150 0,200 50,200
                C100,200 100,250 50,250
                C0,250 0,300 50,300
                C100,300 100,350 50,350
                C0,350 0,400 50,400
                C100,400 100,450 50,450
                C0,450 0,500 50,500
                C100,500 100,550 50,550
                C0,550 0,600 50,600
                C100,600 100,650 50,650
                C0,650 0,700 50,700
                C100,700 100,750 50,750
                C0,750 0,800 50,800
                C100,800 100,850 50,850
                C0,850 0,900 50,900
                C100,900 100,950 50,950
                C0,950 0,1000 50,1000
                C100,1000 100,1050 50,1050"
                    id="theMotionPath"
                />
                <circle
                    cx=""
                    cy=""
                    r="15"
                    fill="#45bcde"
                    id="css-motion-path"
                />
                <circle cx="" cy="" r="15" fill="red">
                    <!-- Define the motion path animation -->
                    <animateMotion dur="5s" repeatCount="indefinite">
                        <mpath xlink:href="#theMotionPath" />
                    </animateMotion>
                </circle>
            </svg>

            <p class="sweet">sweet, isn’t it?</p>
        </section>

        <section>
            <p>and scroll-behavior for this nice, smooth scrolling effect to</p>
        </section>

        <section class="big">
            <p>
                Masks and clips are great idea if you want to hide part of your
                element
            </p>

            <img
                src="https://scroll-driven-animations.style/shared/img/photo-1610570426407-efa770f9d31a.jpeg"
                alt=""
                title=""
                width="1080"
                height="720"
                class="clipped-image"
            />
            <p class="info">and, maybe, show it later with animation</p>
        </section>

        <section>
            <p>
                All this is synchronized with awesome
                <code class="hljs language-css no-break">view-timeline</code>
                possibilites. This and
                <code class="hljs language-css no-break">scroll-timeline</code>
                are new APIs to sync animation with scroll position.
            </p>
        </section>

        <section class="horizontal">
            <p>This really is fun!</p>
            <img src="one.webp" />
            <img src="two.webp" />
            <img src="three.webp" />
        </section>

        <section class="entry-exit">
            <p>
                With
                <code class="hljs language-css no-break">@starting-style</code>
                I can add styles to element just before I add it to DOM and
                transition easily.
            </p>
            <button>Add image</button>
        </section>

        <section class="entry-exit">
            <p>
                <code class="hljs language-css no-break"
                    >transition-behavior: allow-discrete;</code
                >
                allows us to transition element to
                <code class="hljs language-css no-break">display: none</code> to
                remove it from DOM tree at the end of animation.
            </p>
            <img src="one.webp" />
            <img src="two.webp" />
            <img src="three.webp" />
        </section>

        <section class="view-transition">
            <p>View Transition</p>
            <img src="one.webp" />
            <img src="two.webp" />
            <img src="three.webp" />
            <p>
                Are great and easy way to transition between two different DOM
                states
            </p>
        </section>

        <section>
            <pre>
viewTransitionButton.addEventListener("click", () => {
  document.startViewTransition(() => {
    viewTransitionContainer.removeChild(viewTransitionButton);
    viewTransitionContainer.classList.add("gallery");
  });
});</pre
            >

            <pre>
::view-transition-old(root) {
  animation:
    0.8s cubic-bezier(0.4, 0, 1, 1) both fade-out,
    0.8s cubic-bezier(0.4, 0, 0.2, 1) both slide-to-left;
  }

::view-transition-new(root) {
  animation:
    0.8s cubic-bezier(0, 0, 0.2, 1) both fade-in,
    0.8s cubic-bezier(0.4, 0, 0.2, 1) both slide-from-right;
    animation-delay: 1s;
}</pre
            >
        </section>

        <section>
            <p>
                for even more crazy animations and visualizations, run three.js
                on separate thread with Offscreen Canvas
            </p>
        </section>

        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css"
        />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

        <!-- and it's easy to individually load additional languages -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/css.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
        <!--
        <script>
            hljs.highlightAll();
        </script> -->

        <script>
            var preTags = document.getElementsByTagName("pre");
            var size = preTags.length;
            for (var i = 0; i < size; i++) {
                preTags[i].innerHTML =
                    "<code>" + preTags[i].innerHTML + "</code>"; // wrap content of pre tag in code tag
            }
            hljs.highlightAll(); // apply highlighting
        </script>

        <script>
            let idx = 0;
            const imgs = ["one", "two", "three", "four"];

            const button = document.querySelector(".entry-exit button");
            const images = document.querySelectorAll(".entry-exit img");

            button.addEventListener("click", () => {
                const img = document.createElement("img");
                img.src = `${imgs[idx]}.webp`;
                idx++;
                if (idx >= 3) {
                    idx = 0;
                }
                document.querySelector(".entry-exit").appendChild(img);
            });

            Array.from(images).forEach((image) => {
                image.addEventListener("click", (e) => {
                    image.classList.add("removed");
                });
            });

            const viewTransitionContainer =
                document.querySelector(".view-transition");

            const viewTransitionButton = document.querySelector(
                ".view-transition p:first-child",
            );
            viewTransitionButton.addEventListener("click", () => {
                document.startViewTransition(() => {
                    viewTransitionContainer.removeChild(viewTransitionButton);
                    viewTransitionContainer.classList.add("gallery");
                });
            });
        </script>
    </body>
</html>
